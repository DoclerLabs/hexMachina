<script type="text/javascript" src="{{"/lib/codemirror/codemirror.js" | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{"/lib/codemirror/mode/haxe/haxe.js" | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{"/lib/codemirror/mode/xml/xml.js" | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{"/lib/flickity/flickity.pkgd.min.js" | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{"/lib/clipboard/clipboard.min.js" | prepend: site.baseurl }}"></script>

<script>
	(function() {

		var mobileMenu = document.getElementsByClassName('mobile-menu')[0];
		var mobileMenuClass = 'mobile-menu-on';
		var body = document.body;

		mobileMenu.addEventListener('click', toggleMobileMenu);

		function toggleMobileMenu() {
			if (document.body.classList.contains(mobileMenuClass)) {
				body.classList.remove(mobileMenuClass);
				body.removeEventListener('touchmove', onTouchMove);
			}
			else {
				body.classList.add(mobileMenuClass);
				body.addEventListener('touchmove', onTouchMove);
			}
		}

		function onTouchMove(ev) {
			ev.preventDefault();
		}

		window.addEventListener('orientationchange', function() {
			if (document.body.classList.contains(mobileMenuClass)) {
				if (window.innerHeight <= 420) {
					body.removeEventListener('touchmove', onTouchMove);
				}
				else {
					body.addEventListener('touchmove', onTouchMove);
				}
			}
			else {
				body.removeEventListener('touchmove', onTouchMove);
			}
		})

	}());

	var elements = document.getElementsByClassName("code-haxe");
	for(var i=0; i<elements.length; i++) {
		var editor = CodeMirror.fromTextArea(elements[i], {
			mode: "haxe",
			lineNumbers: true,
			theme: "hexmachina",
			lineWrapping: true,
			readOnly: true,
			extraKeys: {
				"Ctrl-Q": function (cm) {
					cm.foldCode(cm.getCursor());
				}
			},
			foldGutter: true,
			gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
		});
	}
	
	var elements = document.getElementsByClassName("code-xml");
	for(var i=0; i<elements.length; i++) {
		var editor = CodeMirror.fromTextArea(elements[i], {
			mode: "xml",
			lineNumbers: true,
			theme: "hexmachina",
			lineWrapping: true,
			readOnly: true,
			extraKeys: {
				"Ctrl-Q": function (cm) {
					cm.foldCode(cm.getCursor());
				}
			},
			foldGutter: true,
			gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
		});
	}

	(function() {
		var verticalMenu = document.getElementById('slide-menu');

		if (verticalMenu) {
			var contentMargin = 30;
			calculateMenuPosition();
			window.addEventListener('resize', calculateMenuPosition);
		}

		function calculateMenuPosition() {
			var verticalMenuTop = verticalMenu.offsetTop;
			var verticalMenuHeight = verticalMenu.clientHeight;
			var content = document.getElementById('slide-container');
			document.addEventListener('scroll', function () {
				var contentHeight = content.clientHeight - contentMargin;
				var scrollTop = window.pageYOffset;
				if (scrollTop > (contentHeight - verticalMenuHeight)) {
					verticalMenu.style.top = contentHeight - verticalMenuHeight + verticalMenuTop - scrollTop + 'px'
				}
				else {
					verticalMenu.style.top = 'auto';
				}
			})
		}
	}());

	var clipboard = new Clipboard('.copy-icon');
	clipboard.on('success', function(e) {
		e.trigger.className += ' copied';
		setTimeout(function(){e.trigger.className = 'copy-icon';}, 3000);
		e.clearSelection();
	});

	clipboard.on('error', function(e) {
		e.trigger.className += ' error';
		setTimeout(function(){e.trigger.className = 'copy-icon';}, 3000);
	});

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-78464445-1', 'auto');
	ga('send', 'pageview');

</script>